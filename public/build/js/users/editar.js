document.addEventListener("DOMContentLoaded",(function(){const e=document.querySelectorAll(".accion.editar"),t=document.getElementById("editarUsuarioModal"),o=document.getElementById("formEditarUsuario");e.forEach((e=>{e.addEventListener("click",(function(){const e=this.closest(".section-usuarios"),o={id:e.dataset.id,nombre:e.querySelector(".nombre-usuarios:nth-of-type(1)").textContent,apellido:e.querySelector(".nombre-usuarios:nth-of-type(2)").textContent,email:e.querySelector(".correo-usuarios").textContent,telefono:e.dataset.telefono||"",estado:e.dataset.estado,admin:e.dataset.admin};document.getElementById("editUsuarioId").value=o.id,document.getElementById("editNombre").value=o.nombre,document.getElementById("editApellido").value=o.apellido,document.getElementById("editEmail").value=o.email,document.getElementById("editTelefono").value=o.telefono,document.getElementById("editEstado").value=o.estado,document.getElementById("editAdmin").value=o.admin,t.classList.add("show"),document.body.style.overflow="hidden"}))})),o.addEventListener("submit",(async function(e){e.preventDefault();const t=new FormData(this),o=this.querySelector('button[type="submit"]'),a=o.textContent;try{o.textContent="Guardando...",o.disabled=!0;const e=await fetch("/dashboard/usuarios/update-user",{method:"POST",body:t});if(!e.ok)throw new Error("Error en la respuesta");const a=await e.json();if(!a.success)throw new Error(a.message||"Error al actualizar");alert("Usuario actualizado correctamente"),window.location.reload()}catch(e){console.error("Error:",e),alert(e.message)}finally{o.textContent=a,o.disabled=!1}})),document.querySelectorAll("#editarUsuarioModal .close-modal, #editarUsuarioModal .modal-btn.cerrar").forEach((e=>{e.addEventListener("click",(()=>{t.classList.remove("show"),document.body.style.overflow="auto"}))})),t.addEventListener("click",(e=>{e.target===t&&(t.classList.remove("show"),document.body.style.overflow="auto")}))}));